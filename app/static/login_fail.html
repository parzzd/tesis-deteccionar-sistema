<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Cuenta bloqueada</title>
<style>
  :root{--bg:#0b0f17;--panel:#0f1522;--card:#0e1421;--mut:#9aa4b2;--txt:#e6edf3;--b:#1e2636;--btn:#335cce}
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--txt)}
  .wrap{min-height:100vh;display:grid;place-items:center;background:radial-gradient(80% 60% at 50% 10%,#0f1729 0%,#0b0f17 60%)}
  .shell{width:min(92vw,480px);background:rgba(12,18,30,.85);border:1px solid #1a2234;border-radius:18px;
         box-shadow:0 10px 40px rgba(0,0,0,.35);padding:32px;text-align:center}
  h1{font-size:26px;margin:0 0 10px;font-weight:800}
  p{margin:8px 0;font-size:15px;color:var(--mut)}
  .timer{font-size:34px;font-weight:700;margin:18px 0;color:#ff6b6b;letter-spacing:1px}
  .btn{padding:10px 18px;border:none;border-radius:12px;background:var(--btn);color:#fff;cursor:pointer;font-weight:600}
  .btn:disabled{opacity:.6;cursor:not-allowed}
</style>
</head>
<body>
<div class="wrap">
  <div class="shell">
    <h1>Cuenta bloqueada temporalmente</h1>
    <p>Por seguridad, se ha superado el número máximo de intentos de inicio de sesión.</p>
    <p>Podrás volver a intentar en:</p>
    <div id="timer" class="timer">05:00</div>
    <p>Por favor, espera o contacta al administrador si el problema persiste.</p>
    <button id="btn" class="btn" disabled>Volver al inicio de sesión</button>
  </div>
</div>

<script>
const btn = document.getElementById('btn');
const timerEl = document.getElementById('timer');

// ⏱ duración total del bloqueo (5 min = 300 segundos)
let remaining = 5 * 60;

// Si el backend guardó el momento exacto del bloqueo, lo usamos
const blockedUntil = localStorage.getItem('blocked_until');
if (blockedUntil) {
  const end = new Date(blockedUntil);
  const diff = Math.floor((end - new Date()) / 1000);
  if (diff > 0) remaining = diff;
}

function formatTime(s){
  const m = String(Math.floor(s/60)).padStart(2,'0');
  const sec = String(s%60).padStart(2,'0');
  return `${m}:${sec}`;
}

function updateTimer(){
  timerEl.textContent = formatTime(remaining);
  if(remaining <= 0){
    clearInterval(interval);
    btn.disabled = false;
    btn.textContent = "Reintentar inicio de sesión";
  } else remaining--;
}

const interval = setInterval(updateTimer, 1000);
updateTimer();

btn.onclick = () => {
  localStorage.removeItem('blocked_until');
  window.location.href = '/static/login.html';
};
</script>
</body>
</html>
